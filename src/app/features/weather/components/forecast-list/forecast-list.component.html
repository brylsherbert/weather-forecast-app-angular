@if (loading()) {
  <div class="flex items-center justify-center p-8">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
  </div>
}

@if (forecastDays().length > 0 && !loading()) {
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6">
    <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">7-Day Forecast</h3>
    
    @let firstDay = forecastDays()[0];
    @let remainingDays = forecastDays().slice(1);
    
    <!-- First Day - Large Row at Top -->
    @if (firstDay) {
      <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 sm:p-6 mb-4 sm:mb-6">
        <div class="flex flex-col justify-center items-center lg:flex-row lg:items-center lg:justify-between gap-4 lg:gap-6">
          <!-- Left Side: Date and Day -->
          <div class="flex flex-col sm:flex-row items-center sm:items-center gap-3 sm:gap-4">
            <div class="text-center sm:text-left shrink-0">
              <div class="text-base sm:text-lg font-semibold text-gray-800 dark:text-gray-100 mb-1">
                {{ getDayName(firstDay.date, 0) }}
              </div>
              <div class="text-xs sm:text-sm text-gray-500 dark:text-gray-400">
                {{ getDate(firstDay.date) }}
              </div>
            </div>
            @if (firstDay.day.condition.icon) {
              <img
                [src]="firstDay.day.condition.icon"
                [alt]="firstDay.day.condition.text"
                class="w-12 h-12 sm:w-16 sm:h-16 shrink-0"
              />
            }
            <div class="text-center sm:text-left flex-1 min-w-0">
              <div class="text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100">
                {{ firstDay.day.maxtemp_c }}째 / {{ firstDay.day.mintemp_c }}째
              </div>
              <div class="text-xs sm:text-sm text-gray-600 dark:text-gray-400 truncate">
                {{ firstDay.day.condition.text }}
              </div>
            </div>
          </div>
          
          <!-- Right Side: Additional Info -->
          <div class="flex flex-wrap gap-3 sm:gap-4 lg:gap-6 justify-center lg:justify-end">
            <div class="flex items-center space-x-1.5 sm:space-x-2 text-xs sm:text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
              </svg>
              <span>{{ firstDay.day.avg_humidity }}%</span>
            </div>
            <div class="flex items-center space-x-1.5 sm:space-x-2 text-xs sm:text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
              </svg>
              <span>{{ firstDay.day.maxwind_kph }} km/h</span>
            </div>
            @if (firstDay.day.totalprecip_mm > 0) {
              <div class="flex items-center space-x-1.5 sm:space-x-2 text-xs sm:text-sm text-blue-500 dark:text-blue-400">
                <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                </svg>
                <span>{{ firstDay.day.totalprecip_mm }}mm</span>
              </div>
            }
          </div>
        </div>
      </div>
    }
    
    <!-- Remaining Days - Grid Layout -->
    @if (remainingDays.length > 0) {
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4">
        @for (day of remainingDays; track day.date_epoch; let i = $index) {
          <div class="flex flex-col items-center bg-gray-50 dark:bg-gray-700 rounded-lg p-3 sm:p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors shadow-sm">
            <!-- Date -->
            <div class="text-[10px] sm:text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1 text-center w-full truncate">
              {{ getDayName(day.date, i + 1) }}
            </div>
            <div class="text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 mb-2 sm:mb-3 text-center">
              {{ getDate(day.date) }}
            </div>
            
            <!-- Weather Icon -->
            @if (day.day.condition.icon) {
              <img
                [src]="day.day.condition.icon"
                [alt]="day.day.condition.text"
                class="w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 mb-2 sm:mb-3"
              />
            }
            
            <!-- Temperature -->
            <div class="text-lg sm:text-xl font-bold text-gray-800 dark:text-gray-100 mb-0.5 sm:mb-1">
              {{ day.day.maxtemp_c }}째
            </div>
            <div class="text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-2 sm:mb-3">
              {{ day.day.mintemp_c }}째
            </div>
            
            <!-- Condition -->
            <div class="text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 text-center mb-2 sm:mb-3 min-h-[28px] sm:min-h-[36px] flex items-center justify-center px-1">
              <span class="line-clamp-2">{{ day.day.condition.text }}</span>
            </div>
            
            <!-- Additional Info Grid -->
            <div class="w-full space-y-1.5 sm:space-y-2 mt-auto">
              <!-- Humidity -->
              <div class="flex items-center justify-center space-x-1 text-[10px] sm:text-xs text-gray-500 dark:text-gray-400">
                <svg class="w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                </svg>
                <span class="truncate">{{ day.day.avg_humidity }}%</span>
              </div>
              
              <!-- Wind -->
              <div class="flex items-center justify-center space-x-1 text-[10px] sm:text-xs text-gray-500 dark:text-gray-400">
                <svg class="w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                <span class="truncate">{{ day.day.maxwind_kph }} km/h</span>
              </div>
              
              <!-- Precipitation -->
              @if (day.day.totalprecip_mm > 0) {
                <div class="flex items-center justify-center space-x-1 text-[10px] sm:text-xs text-blue-500 dark:text-blue-400">
                  <svg class="w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                  </svg>
                  <span class="truncate">{{ day.day.totalprecip_mm }}mm</span>
                </div>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
}

@if (forecastDays().length === 0 && !loading()) {
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 text-center text-gray-500 dark:text-gray-400">
    <p>No forecast data available</p>
  </div>
}
